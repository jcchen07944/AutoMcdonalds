<!DOCTYPE html>
<html lang="zh-tw">
<head>
	<title>AutoMcdonalds</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet">
	<link rel="stylesheet" href="css/icomoon.css">
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<link href="css/vuetify.min.css" rel="stylesheet">

	<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/main.js"></script>
</head>
<body>
	<div id="am-page">
		<aside id="am-aside" class="border js-fullheight">
			<h1 id="am-logo"><a href="index.html">Auto<br>Mcdonalds</a></h1>
			<nav id="am-menu">
				<ul>
					<li><a href="#">Home</a></li>
					<li class="am-active"><a href="#">Register</a></li>
					<li><a href="#">History</a></li>
					<li><a href="#">About</a></li>
				</ul>
			</nav>
			
			<div class="am-footer">
				<p><small><span>&copy; 2019 JCChen. All Rights Reserved.</span></small></p>
				<ul>
					<li><a href="https://github.com/jcchen07944031/AutoMcdonalds" target="_blank"><i class="icon-github"></i></a></li>
				</ul>
			</div>
		</aside>
		<div id="am-content" class="js-fullheight" style="background-image: url(images/img_bg_3.jpg);background-size: cover;">
			<div id="am-register" class="am-content-block" data-app="true">
				<div id="am-register-form">
					<div>
						<span id="am-register-title">登記</span>
					</div>
					<div class="am-wrap-input validate-input" data-validate = "Username is required">
						<input class="am-input" type="text" name="username" placeholder="Username" v-model="username">
					</div>
					<div class="am-wrap-input validate-input" data-validate = "Password is required">
						<input class="am-input" type="password" name="pass" placeholder="Password" v-model="password">
					</div>
					<div class="am-wrap-input validate-input">
						<input class="am-input" type="text" name="keyword" placeholder="Keyword" v-model="keyword">
					</div>
					<div class="am-wrap-button">
						<div id="am-button-register">
							<button class="am-button" @click="btn_register">
								確認
							</button>
						</div>
						<div id="am-button-cancel">
							<button class="am-button" @click="dialog_cancel = true">
								取消
							</button>
						</div>
					</div>
						
				</div>
				<v-dialog v-model="dialog_success" max-width="290">
					<v-card>
						<v-card-title>登記成功</v-card-title>
						<v-card-text></v-card-text>
						<v-card-actions>
							<v-spacer></v-spacer>
							<v-btn color="#228896" text @click="dialog_success = false">確認</v-btn>
						</v-card-actions>
					</v-card>						
				</v-dialog>
				<v-dialog v-model="dialog_fail" max-width="290">
					<v-card>
						<v-card-title>登記失敗</v-card-title>
						<v-card-text>請確認帳號(手機)及密碼或稍後再試</v-card-text>
						<v-card-actions>
							<v-spacer></v-spacer>
							<v-btn color="#228896" text @click="dialog_fail = false">確認</v-btn>
						</v-card-actions>
					</v-card>						
				</v-dialog>
				<v-dialog v-model="dialog_cancel" max-width="290">
					<v-card>
						<v-card-title>是否刪除帳號</v-card-title>
						<v-card-text></v-card-text>
						<v-card-actions>
							<v-spacer></v-spacer>
							<v-btn color="#228896" text @click="do_cancel">確認</v-btn>
							<v-btn color="#228896" text @click="dialog_cancel = false">取消</v-btn>
						</v-card-actions>
					</v-card>						
				</v-dialog>
				<v-dialog v-model="dialog_cancel_success" max-width="290">
					<v-card>
						<v-card-title>刪除成功</v-card-title>
						<v-card-text></v-card-text>
						<v-card-actions>
							<v-spacer></v-spacer>
							<v-btn color="#228896" text @click="dialog_cancel_success = false">確認</v-btn>
						</v-card-actions>
					</v-card>						
				</v-dialog>
				<v-dialog v-model="dialog_cancel_fail" max-width="290">
					<v-card>
						<v-card-title>刪除失敗</v-card-title>
						<v-card-text>請確認帳號(手機)或稍後再試</v-card-text>
						<v-card-actions>
							<v-spacer></v-spacer>
							<v-btn color="#228896" text @click="dialog_cancel_fail = false">確認</v-btn>
						</v-card-actions>
					</v-card>						
				</v-dialog>
			</div>
		</div>
	</div>
	
	<script>
		var register = new Vue({
			el:'#am-register',
			vuetify: new Vuetify(),
			data:{
				username:'',
				password:'',
				keyword:'',
				dialog_success:false,
				dialog_fail:false,
				dialog_cancel:false,
				dialog_cancel_success:false,
				dialog_cancel_fail:false,
			},
			methods: {
				btn_register() {
					axios.post('/AutoMcdonalds/api/register', {
						username: register.username, 
						password: register.password,
						keyword: register.keyword
					})
					.then(function (response) {
						console.log(response);
						if(response.data) {
							register.dialog_success = true;
							register.username = '';
							register.password = '';
							register.keyword = '';
						}
						else {
							register.dialog_fail = true;
							register.password = '';
						}
					})
					.catch(function (error) {
						console.log(error);
					});
				},
				do_cancel() {
					axios.post('/AutoMcdonalds/api/cancel', {
						username: register.username
					})
					.then(function (response) {
						register.dialog_cancel = false;
						console.log(response);
						if(response.data) {
							register.dialog_cancel_success = true;
							register.username = '';
							register.password = '';
							register.keyword = '';
						}
						else {
							register.dialog_cancel_fail = true;
							register.password = '';
							register.keyword = '';
						}
					})
					.catch(function (error) {
						register.dialog_cancel = false;
						console.log(error);
					});
				}
			}
		});
	</script>
</body>
</html>
